@using Core.Modules.UserManagement.RoleViewModels
@model RoleViewModel

<partial name="_AlertMessages" />

<partial name="_PageHeader" model="@((string)null)" />

<div class="row">
    <div class="col-lg-8">
        <div class="card shadow-sm rounded-4 border-0 bg-white mb-4">
            <div class="card-body p-4 p-md-5">
                <div class="d-flex align-items-center gap-3 mb-4 pb-3 border-bottom border-2 border-light">
                    <div class="bg-primary-subtle rounded-4 p-3">
                        <i data-feather="shield" class="feather-lg text-primary"></i>
                    </div>
                    <div>
                        <h3 class="fw-semibold text-body-emphasis mb-1 lh-base">@Model.Name</h3>
                        <p class="text-muted mb-0">Role Information</p>
                    </div>
                </div>

                <div class="row g-4">
                    <div class="col-md-6">
                        <label class="form-label fw-semibold text-muted">Role ID</label>
                        <p class="mb-0 fw-semibold">@Model.Id</p>
                    </div>
                    <div class="col-md-6">
                        <label class="form-label fw-semibold text-muted">Role Name</label>
                        <p class="mb-0 fw-semibold">@Model.Name</p>
                    </div>
                    <div class="col-md-6">
                        <label class="form-label fw-semibold text-muted">Users Count</label>
                        <p class="mb-0">
                            <span class="badge bg-info-subtle text-info fs-6">
                                <i data-feather="users" class="feather-sm me-1"></i>@Model.UsersCount User(s)
                            </span>
                        </p>
                    </div>
                    <div class="col-md-6">
                        <label class="form-label fw-semibold text-muted">Status</label>
                        <p class="mb-0">
                            @if (Model.IsActive)
                            {
                                <span class="d-inline-flex align-items-center p-1 pe-2 rounded-1 text-white bg-success fs-10">
                                    <i class="ti ti-point-filled me-1 fs-11"></i>Active
                                </span>
                            }
                            else
                            {
                                <span class="d-inline-flex align-items-center p-1 pe-2 rounded-1 text-white bg-danger fs-10">
                                    <i class="ti ti-point-filled me-1 fs-11"></i>Inactive
                                </span>
                            }
                        </p>
                    </div>
                    <div class="col-md-6">
                        <label class="form-label fw-semibold text-muted">Created Date</label>
                        <p class="mb-0">@Model.CreatedDate.ToString("dd MMM yyyy")</p>
                    </div>
                    <div class="col-md-6">
                        <label class="form-label fw-semibold text-muted">Permissions Count</label>
                        <p class="mb-0">
                            <span class="badge bg-primary-subtle text-primary fs-6">
                                <i data-feather="shield-check" class="feather-sm me-1"></i>@ViewData["PermissionsCount"] Permission(s)
                            </span>
                        </p>
                    </div>
                </div>

                @if (Model.Name == Roles.SuperAdmin)
                {
                    <div class="alert alert-warning mt-4" role="alert">
                        <i data-feather="alert-triangle" class="feather-sm me-2"></i>
                        <strong>Protected Role:</strong> This is a system-protected role and cannot be edited or deleted.
                    </div>
                }
                else if (Model.UsersCount > 0)
                {
                    <div class="alert alert-info mt-4" role="alert">
                        <i data-feather="info" class="feather-sm me-2"></i>
                        <strong>Note:</strong> This role has @Model.UsersCount user(s) assigned. Reassign users to another role before deleting.
                    </div>
                }
            </div>
        </div>
    </div>

    <div class="col-lg-4">
        <div class="card shadow-sm rounded-4 border-0 bg-white mb-4">
            <div class="card-body p-4">
                <h5 class="fw-semibold mb-4">Quick Actions</h5>
                <div class="d-grid gap-2">
                    <a asp-action="ManagePermissions" asp-route-id="@Model.Id" class="btn btn-primary btn-lg rounded-3">
                        <i data-feather="shield-check" class="feather-sm me-2"></i>Manage Permissions
                    </a>
                    @if (Model.CanEdit)
                    {
                        <a asp-action="Edit" asp-route-id="@Model.Id" class="btn btn-success btn-lg rounded-3">
                            <i data-feather="edit" class="feather-sm me-2"></i>Edit Role
                        </a>
                    }
                    <a asp-action="Index" class="btn btn-light btn-lg rounded-3">
                        <i data-feather="arrow-left" class="feather-sm me-2"></i>Back to List
                    </a>
                </div>
            </div>
        </div>

        @if (ViewData["Permissions"] != null)
        {
            <div class="card shadow-sm rounded-4 border-0 bg-white">
                <div class="card-body p-4">
                    <h5 class="fw-semibold mb-4">Assigned Permissions</h5>
                    <div class="list-group list-group-flush">
                        @foreach (var permission in ViewData["Permissions"] as List<string> ?? new List<string>())
                        {
                            <div class="list-group-item border-0 px-0 py-2">
                                <div class="d-flex align-items-center">
                                    <i data-feather="check-circle" class="feather-sm text-success me-2"></i>
                                    <small class="text-muted">@permission.Replace("Permissions.", "").Replace(".", " ")</small>
                                </div>
                            </div>
                        }
                    </div>
                </div>
            </div>
        }
    </div>
</div>

@section Scripts {
    <script>
        $(document).ready(function () {
            if (feather) {
                feather.replace();
            }
        });
    </script>
}

